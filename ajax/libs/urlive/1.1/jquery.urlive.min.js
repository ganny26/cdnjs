/*
 * jquery.urlive.min.js v1.1.0, jQuery URLive
 *
 * View the plugin repository at:
 * https://github.com/markserbol/urlive
 *
 */

(function(b){var k={container:".urlive-container",target:"_blank",imageSize:"auto",render:!0,disableClick:!1,regexp:/((https?:\/\/)?[\w-@]+(\.[a-z]+)+\.?(:\d+)?(\/\S*)?)/i,yqlSelect:"*",callbacks:{onStart:function(){},onSuccess:function(){},onFail:function(){},noData:function(){},onLoadEnd:function(){},imgError:function(){},onClick:function(){}}},l=function(a){var e=RegExp(location.protocol+"//"+location.hostname),g="http"+(/^https/.test(location.protocol)?"s":"")+"://query.yahooapis.com/v1/public/yql?callback=?";return function(c){var d=/^https?:\/\//i.test(c.url)?c.url:"http://"+c.url;/get/i.test(c.type)&&!/json/i.test(c.dataType)&&!e.test(d)&&/:\/\//.test(d)&&(c.url=g,c.dataType="json",c.data={q:'select {SELECT} from html where url="{URL}" and xpath="*" and compat="html5"'.replace("{SELECT}",c.yqlSelect).replace("{URL}",d+(c.data?(/\?/.test(d)?"&":"?")+b.param(c.data):"")),format:"xml"},!c.success&&c.complete&&(c.success=c.complete,delete c.complete),c.success=function(b){return function(e){b&&b.call(this,{responseText:(e.results[0]||"").replace(/<script[^>]+?\/>|<script(.|\s)*?\/script>/gi,"")},"success")}}(c.success));return a.apply(this,arguments)}}(b.ajax),g=function(){var a=b(this).data("urlive-container")||b(this);return b(a).find(".urlive-link")},h={init:function(a){var e=b.extend(!0,k,a);return this.each(function(){function a(f){l({url:f,type:"GET",yqlSelect:e.yqlSelect,beforeSend:e.callbacks.onStart}).done(function(a){b.isEmptyObject(a.results)?(b.error("YQL request succeeded but with empty results",a),e.callbacks.noData()):(a=a.results[0],html=b("<div/>",{html:a}),get=function(a){return html.find('[property="'+a+'"]').attr("content")||html.find('[name="'+a+'"]').attr("content")||html.find(a).html()||html.find(a).attr("src")},set={image:d.data("image")||get("og:image")||get("img"),title:d.data("title")||get("og:title")||get("title"),description:d.data("description")||get("og:description")||get("description"),url:d.data("url")||get("og:url")||f,type:d.data("type")||get("og:type"),sitename:d.data("site_name")||get("og:site_name")},e.callbacks.onSuccess(set),e.render&&c(set))}).fail(function(a,c,d){b.error("YQL request error: ",c,d);e.callbacks.onFail()})}function c(a){outer=b("<a/>",{"class":"urlive-link",href:a.url,target:e.target});imgWrapper=b("<div/>",{"class":"urlive-img-wrapper"});textWrapper=b("<div/>",{"class":"urlive-text-wrapper"});b.each(a,function(a,c){c&&("image"==a?(img=b("<img/>",{src:c}),img.error(e.callbacks.imgError),img.appendTo(imgWrapper),img.hide().load(function(){var c=b(this).width(),d=b(this).closest(".urlive-link");b(this).addClass("urlive-"+a).show();"auto"==e.imageSize?c>=d.width()?d.addClass("urlive-img-large"):d.addClass("urlive-img-small"):"large"==e.imageSize?d.addClass("urlive-img-large"):"small"==e.imageSize&&d.addClass("urlive-img-small");e.callbacks.onLoadEnd()})):(elem=b("<span/>",{"class":"urlive-"+a,text:c}),elem.appendTo(textWrapper)))});outer.append(imgWrapper,textWrapper).appendTo(d.data("urlive-container"));outer.on("click",e.callbacks.onClick);if(e.disableClick)outer.on("click",function(a){a.preventDefault()})}var d=b(this),f=void 0;d.data("urlive-container",e.container);if(d.is("a"))f=d.attr("href");else var f=d.val()||d.text(),g=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,f=(f=e.regexp.exec(f))&&!g.test(f[0])?f[0]:null;f&&(/\.(?:jpe?g|gif|png)/.test(f)?(g=f.substr(f.lastIndexOf("/")+1),c({image:f,title:g,url:f})):a(f))})},close:function(a){g.apply(this).fadeOut(a)},remove:function(a){var b=g.apply(this);a?b.fadeOut(a,function(){b.remove()}):b.remove()},open:function(a){g.apply(this).fadeIn(a)},disable:function(){g.apply(this).on("click",function(a){a.preventDefault()})},enable:function(){g.apply(this).off("click")}};b.fn.urlive=function(a){if(h[a])return h[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)b.error('Method "'+a+'" does not exist on jquery.urlive');else return h.init.apply(this,arguments)}})(jQuery);