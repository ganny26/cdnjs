/*
 * jquery.urlive.min.js v1.0.3, jQuery URLive
 *
 * View the plugin repository at:
 * https://github.com/markserbol/urlive
 *
 */

(function(e){var t={container:".urlive-container",target:"_blank",imageSize:"auto",render:true,disableClick:false,callbacks:{onStart:function(){},onSuccess:function(){},onFail:function(){},noData:function(){},onLoadEnd:function(){},imgError:function(){},onClick:function(){}}},n=function(t){var n=RegExp(location.protocol+"//"+location.hostname),r="http"+(/^https/.test(location.protocol)?"s":"")+"://query.yahooapis.com/v1/public/yql?callback=?",i='select * from html where url="{URL}" and xpath="*" and compat="html5"';return function(s){var o=s.url;if(/get/i.test(s.type)&&!/json/i.test(s.dataType)&&!n.test(o)&&/:\/\//.test(o)){s.url=r;s.dataType="json";s.data={q:i.replace("{URL}",o+(s.data?(/\?/.test(o)?"&":"?")+e.param(s.data):"")),format:"xml"};if(!s.success&&s.complete){s.success=s.complete;delete s.complete}s.success=function(e){return function(t){if(e){e.call(this,{responseText:(t.results[0]||"").replace(/<script[^>]+?\/>|<script(.|\s)*?\/script>/gi,"")},"success")}}}(s.success)}return t.apply(this,arguments)}}(e.ajax),r=function(){var t=e(this).data("urlive-container")||e(this);return e(t).find(".urlive-link")},i={init:function(r){var i=e.extend(true,t,r);return this.each(function(){function u(e){if(/\.(?:jpe?g|gif|png)/.test(e)){var t=e.substr(e.lastIndexOf("/")+1);f({image:e,title:t,url:e})}else{a(e)}}function a(t){n({url:t,type:"GET",beforeSend:i.callbacks.onStart}).done(function(n){var r=n.results;if(!e.isEmptyObject(r)){r=r[0];html=e("<div/>",{html:r});get=function(e){return html.find('[property="'+e+'"]').attr("content")||html.find('[name="'+e+'"]').attr("content")||html.find(e).html()||html.find(e).attr("src")};set={image:get("og:image")||get("img"),title:get("og:title")||get("title"),url:get("og:url")||t,description:get("og:description"),type:get("og:type"),sitename:get("og:site_name")};i.callbacks.onSuccess(set);if(i.render){f(set)}}else{i.callbacks.noData()}}).fail(function(t,n,r){e.error("YQL request error: ",n,r);i.callbacks.onFail()})}function f(n){anchor=e("<a/>",{"class":"urlive-link",href:n.url,target:i.target});imgWrapper=e("<div/>",{"class":"urlive-img-wrapper"});textWrapper=e("<div/>",{"class":"urlive-text-wrapper"});e.each(n,function(t,n){if(n){if(t=="image"){img=e("<img/>",{src:n});img.error(i.callbacks.imgError);img.appendTo(imgWrapper);img.hide().load(function(){var n=e(this).width(),r=e(this).closest(".urlive-link");e(this).addClass("urlive-"+t).show();if(i.imageSize=="auto"){if(n>=r.width()){r.addClass("urlive-img-large")}else{r.addClass("urlive-img-small")}}else if(i.imageSize=="large"){r.addClass("urlive-img-large")}else if(i.imageSize=="small"){r.addClass("urlive-img-small")}i.callbacks.onLoadEnd()})}else{elem=e("<span/>",{"class":"urlive-"+t,text:n});elem.appendTo(textWrapper)}}});anchor.append(imgWrapper,textWrapper).appendTo(t.data("urlive-container"));anchor.on("click",i.callbacks.onClick);if(i.disableClick){anchor.on("click",function(e){e.preventDefault()})}}var t=e(this),r;t.data("urlive-container",i.container);if(t.is("a")){r=t.attr("href");u(r)}else{var s=t.val()||t.text();var o=/((https?:\/\/)?[\w-]+(\.[\w-]+)+\.?(:\d+)?(\/\S*)?)/i;if(o.test(s)){r=o.exec(s)[0];u(r)}}})},close:function(e){var t=r.apply(this);t.fadeOut(e)},remove:function(e){var t=r.apply(this);if(e){t.fadeOut(e,function(){t.remove()})}else{t.remove()}},open:function(e){var t=r.apply(this);t.fadeIn(e)},disable:function(){var e=r.apply(this);e.on("click",function(e){e.preventDefault()})},enable:function(){var e=r.apply(this);e.off("click")}};e.fn.urlive=function(t){if(i[t]){return i[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return i.init.apply(this,arguments)}else{e.error('Method "'+t+'" does not exist on jquery.urlive')}}})(jQuery)