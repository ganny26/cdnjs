!function(r,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):r.chromatism=e()}(this,function(){"use strict";function r(r,e){return Object.keys(r).every(function(r){return-1!==e.indexOf(r)})}var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},n=function(){function r(r,e){var n=[],t=!0,o=!1,s=void 0;try{for(var a,c=r[Symbol.iterator]();!(t=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);t=!0);}catch(r){o=!0,s=r}finally{try{!t&&c.return&&c.return()}finally{if(o)throw s}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return r(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),t=function(r){if(Array.isArray(r)){for(var e=0,n=Array(r.length);e<r.length;e++)n[e]=r[e];return n}return Array.from(r)},o={hex:{test:function(r){return"string"==typeof r&&"#"===r.slice(0,1)},convert:function(r,e,n){var t=r.conversions,o=r.operations,s=r.helpers;n=n.replace("#","").match(/.{2}/g);for(var a=0;a<n.length;a++)n[a]=parseInt(n[a],16);switch(e){case"rgb":return{r:n[0],g:n[1],b:n[2]};default:return o.convert({conversions:t,operations:o,helpers:s},e,{r:n[0],g:n[1],b:n[2]})}}},rgb:{test:function(e){return r(e,["r","g","b"])},convert:function(r,e,t){var o=r.conversions,s=r.operations,a=r.helpers;switch(e){case"hex":return 1==(m=Math.round(t.r).toString(16)).length&&(m="0"+m),1==(M=Math.round(t.g).toString(16)).length&&(M="0"+M),1==(Y=Math.round(t.b).toString(16)).length&&(Y="0"+Y),"#"+m+M+Y;case"cssrgb":return"rgb("+Math.round(t.r)+","+Math.round(t.g)+","+Math.round(t.b)+")";case"hsl":var c=[m=t.r/255,M=t.g/255,Y=t.b/255].sort(),i=(c[0]+c[2])/2*100;return c[0]==c[2]?(y=0,d=0):(y=i>=50?(c[2]-c[0])/(2-c[2]-c[0])*100:(c[2]-c[0])/(c[2]+c[0])*100,(d=c[2]==m?(M-Y)/(c[2]-c[0])*60:c[2]==M?60*(2+(Y-m)/(c[2]-c[0])):60*(4+(m-M)/(c[2]-c[0])))<0?d+=360:d>360&&(d%=360)),{h:d,s:y,l:i};case"csshsl":var u=s.convert({conversions:o,helpers:a},"hsl",t);return"hsl("+Math.round(u.h)+","+Math.round(u.s)+"%,"+Math.round(u.l)+"%)";case"cmyk":var l=t.r/255,h=t.g/255,v=t.b/255,p=1-Math.max(l,h,v);if(1!=p)var f=(1-l-p)/(1-p),b=(1-h-p)/(1-p),g=(1-v-p)/(1-p);else var f=0,b=0,g=0;return{c:f,m:b,y:g,k:p};case"hsv":var d,y,m=t.r/255,M=t.g/255,Y=t.b/255,w=Math.min(m,M,Y),X=Math.max(m,M,Y),Z=X-w,x=X;if(0==Z)d=0,y=0;else{y=Z/X;var j=((X-m)/6+Z/2)/Z,O=((X-M)/6+Z/2)/Z,S=((X-Y)/6+Z/2)/Z;m==X?d=S-O:M==X?d=1/3+j-S:Y==X&&(d=2/3+O-j),d<0&&(d+=1),d>1&&(d-=1)}return{h:360*d,s:100*y,v:100*x};case"yiq":var g=t.r/255*.299+t.g/255*.587+t.b/255*.114,A=t.r/255*.596+t.g/255*-.274+t.b/255*-.322,L=t.r/255*.211+t.g/255*-.523+t.b/255*.312;return A=a.bounded(A,[-.5957,.5957]),L=a.bounded(L,[-.5226,.5226]),{y:g,i:A,q:L};case"XYZ":var I=[t.r,t.g,t.b].map(function(r){return r/255}).map(function(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}),k=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]].map(function(r){return I.reduce(function(e,n,t){return r[t]*n+e},0)}).map(function(r){return 100*r}),q=n(k,3);return{X:q[0],Y:q[1],Z:q[2]};case"lms":case"cielab":case"xyY":var D=s.convert({conversions:o,operations:s,helpers:a},"XYZ",t);return s.convert({conversions:o,operations:s,helpers:a},e,D)}}},cssrgb:{test:function(r){return"string"==typeof r&&"rgb("===r.slice(0,4)},convert:function(r,e,n){var t=r.conversions,o=r.operations,s=r.helpers;n=n.replace(/((rgb\(|\))|[\s]*)/g,"").split(",");for(var a=0;a<n.length;a++)n[a]=parseInt(n[a]);switch(e){case"rgb":return{r:n[0],g:n[1],b:n[2]};default:return o.convert({conversions:t,operations:o,helpers:s},e,{r:n[0],g:n[1],b:n[2]})}}},hsl:{test:function(e){return r(e,["h","s","l"])},convert:function(r,e,n){var t=r.conversions,o=r.operations,s=r.helpers;switch(e){case"rgb":if(0==n.s){var a=n.l/100*255;return{r:a,g:a,b:a}}var c,i,u;c=n.l>=50?n.l/100+n.s/100-n.l/100*(n.s/100):n.l/100*(1+n.s/100),i=n.l/100*2-c;var l,h,v,p=(.333+(u=n.h/360))%1,f=u,b=s.negMod(u-.333,1);return l=6*p<1?i+6*(c-i)*p:2*p<1?c:3*p<2?i+6*(.666-p)*(c-i):i,h=6*f<1?i+6*(c-i)*f:2*f<1?c:3*f<2?i+6*(.666-f)*(c-i):i,v=6*b<1?i+6*(c-i)*b:2*b<1?c:3*b<2?i+6*(.666-b)*(c-i):i,l<0&&(l=0),h<0&&(h=0),v<0&&(v=0),{r:255*l,g:255*h,b:255*v};case"csshsl":return"hsl("+Math.round(n.h)+","+Math.round(n.s)+"%,"+Math.round(n.l)+"%)";case"hsv":n.s=n.s/100,n.l=n.l/100;var g=n.s*(n.l<.5?n.l:1-n.l);return{h:n.h,s:2*g/(n.l+g)*100,v:100*(n.l+g)};default:var d=o.convert({conversions:t,operations:o,helpers:s},"rgb",n);return o.convert({conversions:t,operations:o,helpers:s},e,d)}}},csshsl:{test:function(r){return"string"==typeof r&&"hsl("===r.slice(0,4)},convert:function(r,e,n){var t=r.conversions,o=r.operations,s=r.helpers;n=n.replace(/(hsl\(|\)|%|[\s]*)/g,"").split(",");for(var a=0;a<n.length;a++)n[a]=parseInt(n[a]);switch(e){case"hsl":return{h:n[0],s:n[1],l:n[2]};default:return o.convert({conversions:t,operations:o,helpers:s},e,{h:n[0],s:n[1],l:n[2]})}}},hsv:{test:function(e){return r(e,["h","s","v"])},convert:function(r,e,n){var t=r.conversions,o=r.operations,s=r.helpers;switch(e){case"rgb":var a,c,i;n.h=n.h/360,n.s=n.s/100,n.v=n.v/100;var u=6*n.h;6==u&&(u=0);var l,h,v,p=Math.round(u),f=n.v*(1-n.s),b=n.v*(1-n.s*(u-p)),g=n.v*(1-n.s*(1-(u-p)));return 0==p?(l=n.v,h=g,v=f):1==p?(l=b,h=n.v,v=f):2==p?(l=f,h=n.v,v=g):3==p?(l=f,h=b,v=n.v):4==p?(l=g,h=f,v=n.v):(l=n.v,h=f,v=b),a=255*l,c=255*h,i=255*v,{r:a,g:c,b:i};case"hsl":return n.h=n.h/360,n.s=n.s/100,n.v=n.v/100,{h:360*n.h,s:100*((2-n.s)*n.v<1?n.s*n.v/((2-n.s)*n.v):n.s*n.v/(2-(2-n.s)*n.v)),l:(2-n.s)*n.v/2*100};default:var d=o.convert({conversions:t,operations:o,helpers:s},"rgb",n);return o.convert({conversions:t,operations:o,helpers:s},e,d)}}},cmyk:{test:function(e){return r(e,["c","m","y","k"])},convert:function(r,e,n){var t=r.conversions,o=r.operations,s=r.helpers;switch(e){case"rgb":return{r:a=255*(1-n.c)*(1-n.k),g:c=255*(1-n.m)*(1-n.k),b:i=255*(1-n.y)*(1-n.k)};case"cssrgb":var a=255*(1-n.c)*(1-n.k),c=255*(1-n.m)*(1-n.k),i=255*(1-n.y)*(1-n.k);return"rgb("+Math.round(a)+","+Math.round(c)+","+Math.round(i)+")";default:var u=o.convert({conversions:t,operations:o,helpers:s},"rgb",n);return o.convert({conversions:t,operations:o,helpers:s},e,u)}}},yiq:{test:function(e){return r(e,["y","i","q"])},convert:function(r,e,n){var t=r.conversions,o=r.operations,s=r.helpers;switch(n.i=s.bounded(n.i,[-.5957,.5957]),n.q=s.bounded(n.q,[-.5226,.5226]),e){case"rgb":var a=255*(n.y+.956*n.i+.621*n.q),c=255*(n.y+-.272*n.i+-.647*n.q),i=255*(n.y+-1.106*n.i+-1.703*n.q);return a=s.bounded(a,[0,255]),c=s.bounded(c,[0,255]),i=s.bounded(i,[0,255]),{r:a,g:c,b:i};default:var u=o.convert({conversions:t,operations:o,helpers:s},"rgb",n);return o.convert({conversions:t,operations:o,helpers:s},e,u)}}},XYZ:{test:function(e){return r(e,["X","Y","Z"])},convert:function(r,e,t){var o=r.conversions,s=r.operations,a=r.helpers;switch(e){case"rgb":var c=[t.X,t.Y,t.Z].map(function(r){return r/100}),i=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]].map(function(r){return c.reduce(function(e,n,t){return r[t]*n+e},0)}).map(function(r){return r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055}).map(function(r){return 255*r}),u=n(i,3),l=u[0],h=u[1],v=u[2];return a.boundedRgb({r:l,g:h,b:v});case"lms":var p=[t.X,t.Y,t.Z].map(function(r){return r/100}),f=[[.8951,.2664,-.1614],[-.7502,1.7135,.0367],[.0389,-.0685,1.0296]].map(function(r){return p.reduce(function(e,n,t){return r[t]*n+e},0)});return{rho:f[0],gamma:f[1],beta:f[2]};case"cielab":var b=a.getIlluminant("D65"),g=t.X/b.X,d=t.Y/b.Y,y=t.Z/b.Z,m=function(r){return r>.008856?a.cbrt(r):(903.3*r+16)/116},M=m(g),Y=m(d);return{L:116*Y-16,a:500*(M-Y),b:200*(Y-m(y))};case"xyY":return{x:t.X/(t.X+t.Y+t.Z),y:t.Y/(t.X+t.Y+t.Z),Y:t.Y};default:var w=a.boundedRgb(s.convert({conversions:o,operations:s,helpers:a},"rgb",t));return s.convert({conversions:o,operations:s,helpers:a},e,w)}}},xyY:{test:function(e){return r(e,["x","y","Y"])},convert:function(r,e,n){var t=r.conversions,o=r.operations,s=r.helpers;switch(e){case"XYZ":var a=n.Y/n.y*n.x,c=n.Y/n.y*(1-n.x-n.y);return{X:a,Y:n.Y,Z:c};default:var i=o.convert({conversions:t,operations:o,helpers:s},"XYZ",n);return o.convert({conversions:t,operations:o,helpers:s},e,i)}}},lms:{test:function(e){return r(e,["rho","gamma","beta"])},convert:function(r,e,n){var t=r.conversions,o=r.operations,s=r.helpers;switch(e){case"XYZ":var a=[n.rho,n.gamma,n.beta],c=[[.9869929,-.1470543,.1599627],[.4323053,.5183603,.0492912],[-.0085287,.0400428,.9684867]].map(function(r){return a.reduce(function(e,n,t){return r[t]*n+e},0)});return{X:100*c[0],Y:100*c[1],Z:100*c[2]};default:var i=o.convert({conversions:t,operations:o,helpers:s},"XYZ",n);return o.convert({conversions:t,operations:o,helpers:s},e,i)}}},cielab:{test:function(e){return r(e,["L","a","b"])},convert:function(r,e,n){var t=r.conversions,o=r.operations,s=r.helpers;switch(e){case"XYZ":var a=s.getIlluminant("D65"),c=(n.L+16)/116,i=n.a/500+c,u=c-n.b/200,l=function(r){return Math.pow(r,3)>.008856?Math.pow(r,3):(116*r-16)/903.3},h=l(i),v=l(u),p=n.L>903.3*.008856?Math.pow(c,3):n.L/903.3;return{X:h*a.X,Y:p*a.Y,Z:v*a.Z};default:var f=o.convert({conversions:t,operations:o,helpers:s},"XYZ",n);return o.convert({conversions:t,operations:o,helpers:s},e,f)}}}},s={adapt:function(r,e,n,t){var o=r.operations.convert(r,"XYZ",e),s=r.operations.convert(r,"lms",n);if(t)a=r.operations.convert(r,"lms",t);else var a=r.operations.convert(r,"lms",r.helpers.getIlluminant("D65"));var c=[[.8951,.2664,-.1614],[-.7502,1.7135,.0367],[.0389,-.0685,1.0296]],i=[[.9869929,-.1470543,.1599627],[.4323053,.5183603,.0492912],[-.0085287,.0400428,.9684867]],u=[[s.rho/a.rho,0,0],[0,s.gamma/a.gamma,0],[0,0,s.beta/a.beta]],l=r.helpers.matrixMultiply(i,u),h=r.helpers.matrixMultiply(l,c),v=[[o.X],[o.Y],[o.Z]],p=r.helpers.matrixMultiply(h,v),f={X:p[0][0],Y:p[1][0],Z:p[2][0]};return r.helpers.ready(r,f)},adjacent:function(r,e,n,t){for(var o=r.operations.convert(r,"hsl",t),s=[{h:o.h,s:o.s,l:o.l}],a=0;a<n-1;a++)o.h=r.helpers.negMod(o.h+e,360),s.push({h:o.h,s:o.s,l:o.l});return r.helpers.ready(r,s)},brightness:function(r,e,n){var t=r.operations.convert(r,"hsl",n);return t.l+=e,t.l<0?t.l=0:t.l>100&&(t.l=100),r.helpers.ready(r,t)},complementary:function(r,e){var n=r.operations.convert(r,"hsl",e);return n.h=(n.h+180)%360,r.helpers.ready(r,n)},contrast:function(r,e,n){var t=r.operations.convert(r,"rgb",n);return t.r=255*((t.r/255-.5)*e+.5),t.r<0?t.r=0:t.r>255&&(t.r=255),t.g=255*((t.g/255-.5)*e+.5),t.g<0?t.g=0:t.g>255&&(t.g=255),t.b=255*((t.b/255-.5)*e+.5),t.b<0?t.b=0:t.b>255&&(t.b=255),r.helpers.ready(r,t)},contrastRatio:function(r,e){var n=r.operations.convert(r,"rgb",e);return n=(299*n.r+587*n.g+114*n.b)/1e3>=128?{r:0,g:0,b:0}:{r:255,g:255,b:255},r.helpers.ready(r,n)},convert:function(r,e,n){if(Object.keys(r.conversions).indexOf(e)>-1){n.colour?n=n.colour:n.colours&&(n=n.colours);var t=r.helpers.determineMode(n);return t!=e?r.conversions[t].convert(r,e,n):n}return r.helpers.ready(r,e)},difference:function(r,e,n,t,o){t=t||1,o=o||1;var s=r.operations.convert(r,"cielab",e),a=r.operations.convert(r,"cielab",n),c=Math.sqrt(Math.pow(s.a,2)+Math.pow(s.b,2)),i=c-Math.sqrt(Math.pow(a.a,2)+Math.pow(a.b,2)),u=s.L-a.L,l=s.a-a.a,h=s.b-a.b,v=Math.sqrt(Math.pow(l,2)+Math.pow(h,2)-Math.pow(i,2)),p=s.L<16?.511:.040975*s.L/(1.01765*s.L),f=.0638*c/(1.0131*c),b=Math.atan2(s.b,s.a),g=b>=0?b:b+360,d=164<=g&&g<=345?.56+Math.abs(.2*Math.cos(r.helpers.toRad(g+168))):.36+Math.abs(.4*Math.cos(r.helpers.toRad(g+35))),y=Math.pow(c,4)/(Math.pow(c,4)+1900),m=f*(y*d+1-y),M=Math.pow(u/(t*p),2);Math.pow(i/(o*f),2),Math.pow(v/m,2);return Math.sqrt(M+M+M)},fade:function(r,e,n,t){var o=r.operations.convert(r,"rgb",n),s=r.operations.convert(r,"rgb",t),a=[o];e-=1;for(var c=(s.r-o.r)/e,i=(s.g-o.g)/e,u=(s.b-o.b)/e,l={r:o.r,g:o.g,b:o.b},h=0;h<e-1;h++)l.r=r.helpers.slopeMod(l.r+c,255),l.g=r.helpers.slopeMod(l.g+i,255),l.b=r.helpers.slopeMod(l.b+u,255),a.push({r:l.r,g:l.g,b:l.b});return a.push(s),r.helpers.ready(r,a)},greyscale:function(r,e){var n=r.operations.convert(r,"rgb",e),t=(n.r+n.g+n.b)/3;return n={r:t,g:t,b:t},r.helpers.ready(r,n)},hue:function(r,e,n){var t=r.operations.convert(r,"hsl",n);return t.h=r.helpers.negMod(t.h+e,360),r.helpers.ready(r,t)},invert:function(r,e){var n=r.operations.convert(r,"rgb",e);return n.r=r.helpers.negMod(255-n.r,255),n.g=r.helpers.negMod(255-n.g,255),n.b=r.helpers.negMod(255-n.b,255),r.helpers.ready(r,n)},invertLightness:function(r,e){var n=r.operations.convert(r,"hsl",e);return n.l=100-n.l,r.helpers.ready(r,n)},mid:function(r,e,n){var t=r.operations.convert(r,"hsl",e),o=r.operations.convert(r,"hsl",n),s={h:(t.h+o.h)/2,s:(t.s+o.s)/2,l:(t.l+o.l)/2};return r.helpers.ready(r,s)},multiply:function(r,e,n){var t=r.operations.convert(r,"hsl",e),o=r.operations.convert(r,"hsl",n),s={h:t.h,s:t.s,l:t.l/100*(o.l/100)*100};return s.l=s.l>100?100:s.l,s.l=s.l<0?0:s.l,r.helpers.ready(r,s)},saturation:function(r,e,n){var t=r.operations.convert(r,"hsl",n);return t.s+=e,t.s<0?t.s=0:t.s>100&&(t.s=100),r.helpers.ready(r,t)},sepia:function(r,e){var n=r.operations.convert(r,"rgb",e),t={};return t.r=.393*n.r+.769*n.g+.189*n.b,t.g=.349*n.r+.686*n.g+.168*n.b,t.b=.272*n.r+.534*n.g+.131*n.b,r.helpers.ready(r,t)},shade:function(r,e,n){var t=r.operations.convert(r,"hsv",n);return t.v+=e,t.v<0?t.v=0:t.v>100&&(t.v=100),r.helpers.ready(r,t)},tetrad:function(r,e){for(var n=r.operations.convert(r,"hsl",e),t=[{h:n.h,s:n.s,l:n.l}],o=0;o<3;o++)n.h=(n.h+90)%360,t.push({h:n.h,s:n.s,l:n.l});return r.helpers.ready(r,t)},triad:function(r,e){for(var n=r.operations.convert(r,"hsl",e),t=[{h:n.h,s:n.s,l:n.l}],o=0;o<2;o++)n.h=(n.h+120)%360,t.push({h:n.h,s:n.s,l:n.l});return r.helpers.ready(r,t)}},a={ILLUMINANTS:{A:{X:1.0985*100,Y:100,Z:35.585},B:{X:99.072,Y:100,Z:85.223},C:{X:98.074,Y:100,Z:118.232},D50:{X:96.422,Y:100,Z:82.521},D55:{X:95.682,Y:100,Z:92.149},D65:{X:95.047,Y:100,Z:108.883},D75:{X:94.972,Y:100,Z:122.638},E:{X:100,Y:100,Z:100},F2:{X:.99186*100,Y:100,Z:67.393},F7:{X:95.041,Y:100,Z:108.747},F11:{X:1.00962*100,Y:100,Z:64.35}}},c=function(r,n,o){var s=Object.keys(r.operations).reduce(function(n,s){var a=r.operations[s];return n[s]=function(){for(var n=arguments.length,s=Array(n),c=0;c<n;c++)s[c]=arguments[c];var i=s.slice(0).map(function(r){return"object"===(void 0===r?"undefined":e(r))?Object.assign({},r):r});if(o&&o.colours){return function e(n){return r.helpers.ready(r,n.map(function(n){if(Array.isArray(n)){var o=e(n);return o.colours||o.colour}var s=a.apply(void 0,[r].concat(t(i),[n]));return s.colours||s.colour}))}(o.colours)}return a.apply(void 0,[r].concat(t(i),[o?o.colour:void 0]))},n},{});return o||(s=Object.assign(s,n)),s},i={getIlluminant:function(r){return a.ILLUMINANTS[r]},matrixMultiply:function(r,e){if(r[0].length!=e.length)throw"error: incompatible sizes";for(var n=[],t=0;t<r.length;t++){n[t]=[];for(var o=0;o<e[0].length;o++){for(var s=0,a=0;a<r[0].length;a++)s+=r[t][a]*e[a][o];n[t][o]=s}}return n},cbrt:function(r){if(Math.cbrt)return Math.cbrt(r);var e=Math.pow(Math.abs(r),1/3);return r<0?-e:e},toRad:function(r){return r*(Math.PI/180)},toDeg:function(r){return r*(180/Math.PI)},negMod:function(r,e){return(r%e+e)%e},slopeMod:function(r){function e(e,n){return r.apply(this,arguments)}return e.toString=function(){return r.toString()},e}(function(r,e){return r>2*e?slopeMod(r-2*e,e):r>e?2*e-r:r<0?slopeMod(r+2*e,e):r}),bounded:function(r,e){return r<e[0]?r=e[0]:r>e[1]&&(r=e[1]),r},boundedRgb:function(r){var e=this,n=function(r){return e.bounded(r,[0,255])};return{r:n(r.r),g:n(r.g),b:n(r.b)}},determineMode:function(r){for(var e in o)if(o.hasOwnProperty(e)&&o[e].test(r))return e;return null},ready:function(r,e){var n=r.conversions,t=r.operations,o=r.helpers,s={};switch(Object.prototype.toString.call(e)){case"[object Object]":case"[object String]":s.colour=e;for(var i in n)n.hasOwnProperty(i)&&function(r){Object.defineProperty(s,r,{get:function(){o.determineMode(e);return t.convert({conversions:n,operations:t,helpers:o},r,e)},enumerable:!0})}(i);return s=Object.assign(s,c({conversions:n,operations:t,helpers:o},a,s));case"[object Array]":s.colours=e;for(var u in n)n.hasOwnProperty(u)&&function(r){Object.defineProperty(s,r,{get:function(){return function e(s){return s.map(function(s){return Array.isArray(s)?e(s):t.convert({conversions:n,operations:t,helpers:o},r,s)})}(e)},enumerable:!0})}(u);return s=Object.assign(s,c({conversions:n,operations:t,helpers:o},a,s));default:return null}}};return c({conversions:o,operations:s,helpers:i},a)});